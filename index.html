<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Leaflet with Table Export</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    #map { height: 60vh; }
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 5px;
    }
    #exportBtn {
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h3>ğŸ’§ Ø¢Ø¨Ø§Ø± Ø§Ù„Ù…ÙŠØ§Ù‡ - Wells Table</h3>

<!-- Ø¬Ø¯ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª -->
<table id="dataTable">
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Well A</td>
      <td>Ramallah</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Well B</td>
      <td>Jenin</td>
    </tr>
  </tbody>
</table>

<!-- Ø²Ø± Ø§Ù„ØªØµØ¯ÙŠØ± -->
<button id="exportBtn">ğŸ“¥ ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel</button>

<!-- Ø®Ø±ÙŠØ·Ø© -->
<div id="map"></div>

<!-- Ù…ÙƒØªØ¨Ø© Leaflet -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Ù…ÙƒØªØ¨Ø© SheetJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
  // Ø®Ø±ÙŠØ·Ø© Leaflet
  const map = L.map('map').setView([32, 35], 8);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  // ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
  document.getElementById('exportBtn').addEventListener('click', function () {
    const table = document.getElementById("dataTable");
    const workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    XLSX.writeFile(workbook, "WellsData.xlsx");
  });
</script>

</body>
</html>

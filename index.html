<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Leaflet with Table Export</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    #map { height: 60vh; }
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 5px;
    }
    #exportBtn {
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h3>💧 آبار المياه - Wells Table</h3>

<!-- جدول بيانات -->
<table id="dataTable">
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Well A</td>
      <td>Ramallah</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Well B</td>
      <td>Jenin</td>
    </tr>
  </tbody>
</table>

<!-- زر التصدير -->
<button id="exportBtn">📥 تصدير إلى Excel</button>

<!-- خريطة -->
<div id="map"></div>

<!-- مكتبة Leaflet -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- مكتبة SheetJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
  // خريطة Leaflet
  const map = L.map('map').setView([32, 35], 8);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  // وظيفة التصدير إلى Excel
  document.getElementById('exportBtn').addEventListener('click', function () {
    const table = document.getElementById("dataTable");
    const workbook = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    XLSX.writeFile(workbook, "WellsData.xlsx");
  });
</script>

</body>
</html>
